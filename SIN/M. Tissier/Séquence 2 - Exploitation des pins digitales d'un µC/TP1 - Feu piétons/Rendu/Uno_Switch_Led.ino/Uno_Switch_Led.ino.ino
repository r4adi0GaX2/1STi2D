#define SWITCH 	2
#define LED 	3

#define BLINKSPEED 100
#define SWITCHSPEED 100

uint8_t ledmode = false;
uint8_t lastswitchstate = false;
uint32_t lastledchange = millis();
uint32_t lastswitchread = millis();

void setup() {
	pinMode(LED,OUTPUT);
}

void loop() {
	switch_action();
	led_blink();
}

void switch_action() {
	if (millis() - lastswitchread < SWITCHSPEED)
		return;
	lastswitchread = millis();
	if (digitalRead(SWITCH) == lastswitchstate)
		return;
	lastswitchstate = digitalRead(SWITCH);
	if (not lastswitchstate)
		return;
	ledmode = !ledmode;
}

void led_blink() {
	if (not ledmode) {
		if (digitalRead(LED))
			digitalWrite(LED,LOW);
		return;
	}
	if (millis() - lastledchange > BLINKSPEED) {
		digitalWrite(LED,!digitalRead(LED));
		lastledchange = millis();
	}
}
